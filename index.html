<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>æœˆé…Œæ–°æ˜¥å°æˆ°è¡¨ - è‡ªå‹•æ™‰ç´šç‰ˆ</title>
    <style>
        :root { --main-blue: #1e5bb9; --bg-yellow: #ffe0b2; --line-color: #ccc; --active-color: #ff9800; }
        body { font-family: "Microsoft JhengHei", sans-serif; background: #f8f9fa; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        
        .header { background: var(--main-blue); color: white; padding: 15px 40px; border-radius: 8px; font-size: 24px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .info { text-align: center; margin-bottom: 30px; color: #666; font-size: 14px; }

        .tournament { display: flex; gap: 60px; align-items: flex-start; position: relative; }
        .group-title { background: #ffcc80; padding: 5px 20px; font-weight: bold; margin-bottom: 30px; border-radius: 4px; }

        /* éšŠä¼æ¡†æ¨£å¼ */
        .team-input { 
            background: var(--bg-yellow); border: 2px solid #ffb74d; padding: 8px; 
            text-align: center; width: 100px; border-radius: 6px; cursor: pointer;
            transition: all 0.3s; position: relative; z-index: 2;
        }
        .team-input:hover { border-color: var(--active-color); background: #fff3e0; }
        .team-input:focus { background: white; outline: none; border-color: var(--active-color); }

        /* ç·šæ¢å®¹å™¨ */
        .matchup { display: flex; flex-direction: column; align-items: center; position: relative; }
        .line { 
            width: 2px; height: 30px; background: var(--line-color); 
            margin: 5px 0; transition: background 0.5s ease; position: relative;
        }
        .line.active { background: var(--active-color); box-shadow: 0 0 8px var(--active-color); }
        
        /* æ©«å‘é€£æ¥ç·š */
        .connector-h { 
            display: flex; justify-content: center; position: relative; width: 100%;
        }
        .connector-h::before {
            content: ""; position: absolute; top: 0; height: 2px; width: 50%;
            background: var(--line-color); transition: background 0.5s;
        }
        .connector-h.active::before { background: var(--active-color); }

        /* æ§åˆ¶æŒ‰éˆ• */
        .controls { position: fixed; bottom: 20px; right: 20px; display: flex; gap: 10px; }
        .btn { 
            padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; 
            background: #333; color: white; font-weight: bold; transition: 0.2s;
        }
        .btn:hover { background: #555; }
        .undo-btn { background: #e53935; }
        .undo-btn:hover { background: #c62828; }

        .label-text { font-size: 12px; color: #888; margin: 4px 0; }
    </style>
</head>
<body>

    <div class="header">æœˆé…Œæ–°æ˜¥æ´»å‹•â€œçœ‹èµ·ä¾†å¾ˆæœƒæ‰“â€</div>
    <div class="info">ğŸ’¡ æ“ä½œèªªæ˜ï¼š<b>æŒ‰å…©ä¸‹(Double Click)</b> éšŠä¼æ¡†å¯æ™‰ç´šä¸‹ä¸€è¼ª | <b>å³ä¸‹è§’</b> å¯é€€å›</div>

    <div class="tournament">
        <div class="group">
            <center><div class="group-title">A çµ„</div></center>
            <div style="display: flex; gap: 40px;">
                <div class="matchup">
                    <div style="display: flex; gap: 10px;">
                        <input type="text" class="team-input" value="ç¬¬ä¸€éšŠ" id="a1" ondblclick="promote('a1', 'a_win1', 'line_a1')">
                        <input type="text" class="team-input" value="ç¬¬äºŒéšŠ" id="a2" ondblclick="promote('a2', 'a_win1', 'line_a1')">
                    </div>
                    <div class="label-text">å‹è€…æ™‰ç´š</div>
                    <div class="line" id="line_a1"></div>
                    <input type="text" class="team-input" placeholder="ç¬¬XéšŠ" id="a_win1" ondblclick="promote('a_win1', 'a_final', 'line_af')">
                </div>
                <div class="matchup" style="justify-content: flex-start; padding-top: 10px;">
                    <input type="text" class="team-input" value="ç¬¬ä¸‰éšŠ" id="a3" ondblclick="promote('a3', 'a_final', 'line_af')">
                </div>
            </div>
            <div class="matchup" style="margin-top: 20px;">
                <div class="label-text">ä¸‰æˆ°å…©å‹</div>
                <div class="line" style="width: 140px; height: 2px;" id="line_af"></div>
                <input type="text" class="team-input" placeholder="Açµ„å‹è€…" id="a_final" ondblclick="promote('a_final', 'grand_final', 'line_last')">
            </div>
        </div>

        <div class="group">
            <center><div class="group-title">B çµ„</div></center>
            <div style="display: flex; gap: 40px;">
                <div class="matchup" style="justify-content: flex-start; padding-top: 10px;">
                    <input type="text" class="team-input" value="ç¬¬å››éšŠ" id="b1" ondblclick="promote('b1', 'b_final', 'line_bf')">
                </div>
                <div class="matchup">
                    <div style="display: flex; gap: 10px;">
                        <input type="text" class="team-input" value="ç¬¬äº”éšŠ" id="b2" ondblclick="promote('b2', 'b_win1', 'line_b1')">
                        <input type="text" class="team-input" value="ç¬¬å…­éšŠ" id="b3" ondblclick="promote('b3', 'b_win1', 'line_b1')">
                    </div>
                    <div class="label-text">å‹è€…æ™‰ç´š</div>
                    <div class="line" id="line_b1"></div>
                    <input type="text" class="team-input" placeholder="ç¬¬XéšŠ" id="b_win1" ondblclick="promote('b_win1', 'b_final', 'line_bf')">
                </div>
            </div>
            <div class="matchup" style="margin-top: 20px;">
                <div class="label-text">ä¸‰æˆ°å…©å‹</div>
                <div class="line" style="width: 140px; height: 2px;" id="line_bf"></div>
                <input type="text" class="team-input" placeholder="Bçµ„å‹è€…" id="b_final" ondblclick="promote('b_final', 'grand_final', 'line_last')">
            </div>
        </div>
    </div>

    <div class="matchup" style="margin-top: 40px; width: 100%;">
        <div class="label-text">äº”æˆ°ä¸‰å‹ ç¸½æ±ºè³½</div>
        <div class="line" style="height: 40px;" id="line_last"></div>
        <input type="text" class="team-input" value="æœ€å¾Œå† è»" id="grand_final" style="width: 180px; font-size: 20px; font-weight: bold; height: 40px;">
    </div>

    <div class="controls">
        <button class="btn undo-btn" onclick="undo()">â¬… é€€å›ä¸Šä¸€æ­¥</button>
        <button class="btn" onclick="location.reload()">ğŸ”„ é‡è¨­å…¨éƒ¨</button>
    </div>

    <script>
        let history = [];

        function promote(fromId, toId, lineId) {
            const fromEl = document.getElementById(fromId);
            const toEl = document.getElementById(toId);
            const lineEl = document.getElementById(lineId);

            // ç´€éŒ„æ­·å²ç´€éŒ„ (ç”¨æ–¼é€€å›)
            history.push({
                toId: toId,
                oldValue: toEl.value,
                lineId: lineId,
                lineWasActive: lineEl.classList.contains('active')
            });

            // åŸ·è¡Œæ™‰ç´š
            toEl.value = fromEl.value;
            
            // è§¸ç™¼å‹•ç•«
            lineEl.classList.remove('active');
            void lineEl.offsetWidth; // è§¸ç™¼é‡ç¹ª
            lineEl.classList.add('active');
        }

        function undo() {
            if (history.length === 0) return;
            const lastAction = history.pop();
            
            const toEl = document.getElementById(lastAction.toId);
            const lineEl = document.getElementById(lastAction.lineId);

            toEl.value = lastAction.oldValue;
            if (!lastAction.lineWasActive) {
                lineEl.classList.remove('active');
            }
        }
    </script>
</body>
</html>
